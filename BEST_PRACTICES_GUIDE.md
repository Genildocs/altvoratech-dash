# üìö Guia de Melhores Pr√°ticas - ALTVORA Design System

## üìã **√çndice**
1. [Princ√≠pios de Design](#princ√≠pios-de-design)
2. [Melhores Pr√°ticas de C√≥digo](#melhores-pr√°ticas-de-c√≥digo)
3. [Performance e Otimiza√ß√£o](#performance-e-otimiza√ß√£o)
4. [Acessibilidade](#acessibilidade)
5. [Troubleshooting](#troubleshooting)
6. [Checklist de Qualidade](#checklist-de-qualidade)

---

## üé® **Princ√≠pios de Design**

### **1. Consist√™ncia Visual**
```jsx
// ‚úÖ BOM: Usar classes padronizadas
<button className="btn-primary">A√ß√£o</button>

// ‚ùå RUIM: Estilos inline inconsistentes
<button style={{backgroundColor: '#3b82f6', padding: '8px 16px'}}>A√ß√£o</button>
```

### **2. Hierarquia Clara**
```jsx
// ‚úÖ BOM: Hierarquia bem definida
<div>
  <h1 className="text-3xl font-bold text-gray-900 dark:text-white">T√≠tulo Principal</h1>
  <h2 className="text-xl font-semibold text-gray-800 dark:text-gray-200">Subt√≠tulo</h2>
  <p className="text-gray-600 dark:text-gray-400">Texto do corpo</p>
</div>

// ‚ùå RUIM: Hierarquia confusa
<div>
  <h3 className="text-2xl">T√≠tulo</h3>
  <h1 className="text-lg">Subt√≠tulo</h1>
</div>
```

### **3. Espa√ßamento Consistente**
```jsx
// ‚úÖ BOM: Usar escala de espa√ßamento do Tailwind
<div className="space-y-4">  {/* 16px */}
  <div className="mb-6">    {/* 24px */}
    <div className="p-8">   {/* 32px */}

// ‚ùå RUIM: Valores arbitr√°rios
<div style={{marginBottom: '17px', padding: '13px'}}>
```

---

## üíª **Melhores Pr√°ticas de C√≥digo**

### **1. Estrutura de Componentes**
```jsx
// ‚úÖ BOM: Componente bem estruturado
import { useState } from 'react';
import { cn } from '../utils/cn';

const Button = ({ 
  children, 
  variant = 'primary', 
  size = 'md',
  loading = false,
  className,
  ...props 
}) => {
  return (
    <button
      className={cn(
        'btn-base', // classe base
        `btn-${variant}`, // variante
        `btn-${size}`, // tamanho
        loading && 'opacity-50 cursor-not-allowed',
        className // customiza√ß√µes
      )}
      disabled={loading}
      {...props}
    >
      {loading ? <LoadingSpinner /> : children}
    </button>
  );
};

export default Button;
```

### **2. Gerenciamento de Estado**
```jsx
// ‚úÖ BOM: Estado local para UI, contexto para dados globais
const Component = () => {
  const [isOpen, setIsOpen] = useState(false); // UI state
  const { user } = useAuth(); // Global state
  const { isDark } = useTheme(); // Global state
  
  return (
    <div className={cn('component', isDark && 'dark-variant')}>
      {/* content */}
    </div>
  );
};
```

### **3. Hooks Customizados**
```jsx
// ‚úÖ BOM: L√≥gica reutiliz√°vel em hooks
const useLocalStorage = (key, initialValue) => {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error(`Error reading localStorage key "${key}":`, error);
      return initialValue;
    }
  });

  const setValue = (value) => {
    try {
      setStoredValue(value);
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error(`Error setting localStorage key "${key}":`, error);
    }
  };

  return [storedValue, setValue];
};
```

### **4. Tratamento de Erros**
```jsx
// ‚úÖ BOM: Error boundaries e tratamento adequado
const ErrorBoundary = ({ children, fallback }) => {
  const [hasError, setHasError] = useState(false);

  useEffect(() => {
    const handleError = (error) => {
      console.error('Error caught by boundary:', error);
      setHasError(true);
    };

    window.addEventListener('error', handleError);
    return () => window.removeEventListener('error', handleError);
  }, []);

  if (hasError) {
    return fallback || <ErrorState onRetry={() => setHasError(false)} />;
  }

  return children;
};
```

---

## ‚ö° **Performance e Otimiza√ß√£o**

### **1. Lazy Loading**
```jsx
// ‚úÖ BOM: Componentes lazy
import { lazy, Suspense } from 'react';

const Dashboard = lazy(() => import('./pages/Dashboard'));
const Projects = lazy(() => import('./pages/Projects'));

const App = () => (
  <Suspense fallback={<LoadingSpinner />}>
    <Routes>
      <Route path="/" element={<Dashboard />} />
      <Route path="/projects" element={<Projects />} />
    </Routes>
  </Suspense>
);
```

### **2. Memoiza√ß√£o**
```jsx
// ‚úÖ BOM: Memoizar componentes pesados
import { memo, useMemo, useCallback } from 'react';

const ExpensiveComponent = memo(({ data, onUpdate }) => {
  const processedData = useMemo(() => {
    return data.map(item => ({
      ...item,
      processed: heavyCalculation(item)
    }));
  }, [data]);

  const handleUpdate = useCallback((id, updates) => {
    onUpdate(id, updates);
  }, [onUpdate]);

  return (
    <div>
      {processedData.map(item => (
        <Item key={item.id} data={item} onUpdate={handleUpdate} />
      ))}
    </div>
  );
});
```

### **3. Otimiza√ß√£o de Bundle**
```javascript
// vite.config.js
export default {
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          router: ['react-router-dom'],
          ui: ['lucide-react', 'react-hot-toast']
        }
      }
    }
  }
};
```

---

## ‚ôø **Acessibilidade**

### **1. Navega√ß√£o por Teclado**
```jsx
// ‚úÖ BOM: Suporte completo a teclado
const Modal = ({ isOpen, onClose, children }) => {
  useEffect(() => {
    if (!isOpen) return;

    const handleEscape = (e) => {
      if (e.key === 'Escape') onClose();
    };

    const handleTab = (e) => {
      // Trap focus dentro do modal
      const focusableElements = modal.current.querySelectorAll(
        'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
      );
      
      const firstElement = focusableElements[0];
      const lastElement = focusableElements[focusableElements.length - 1];

      if (e.key === 'Tab') {
        if (e.shiftKey && document.activeElement === firstElement) {
          e.preventDefault();
          lastElement.focus();
        } else if (!e.shiftKey && document.activeElement === lastElement) {
          e.preventDefault();
          firstElement.focus();
        }
      }
    };

    document.addEventListener('keydown', handleEscape);
    document.addEventListener('keydown', handleTab);
    
    return () => {
      document.removeEventListener('keydown', handleEscape);
      document.removeEventListener('keydown', handleTab);
    };
  }, [isOpen, onClose]);

  return (
    <div
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
      className="modal"
    >
      {children}
    </div>
  );
};
```

### **2. ARIA Labels e Roles**
```jsx
// ‚úÖ BOM: Labels e roles apropriados
<button
  aria-label="Fechar modal"
  aria-expanded={isOpen}
  onClick={onClose}
>
  <X className="h-5 w-5" />
</button>

<nav role="navigation" aria-label="Menu principal">
  <ul role="menubar">
    <li role="none">
      <a role="menuitem" href="/dashboard">Dashboard</a>
    </li>
  </ul>
</nav>

<div role="status" aria-live="polite">
  {loading ? 'Carregando...' : 'Dados carregados'}
</div>
```

### **3. Contraste e Legibilidade**
```css
/* ‚úÖ BOM: Contraste adequado (WCAG AA) */
.text-primary {
  color: #111827; /* Contraste 16.75:1 */
}

.dark .text-primary {
  color: #ffffff; /* Contraste 21:1 */
}

/* ‚úÖ BOM: Focus vis√≠vel */
.focus-visible {
  @apply outline-none ring-2 ring-primary-500 ring-offset-2;
}
```

---

## üîß **Troubleshooting**

### **1. Dark Mode n√£o Funciona**
```javascript
// Problema: Classes dark: n√£o aplicadas
// Solu√ß√£o: Verificar configura√ß√£o do Tailwind
module.exports = {
  darkMode: 'class', // ‚Üê Deve estar configurado
  // ...
}

// Problema: Tema n√£o persiste
// Solu√ß√£o: Verificar localStorage
useEffect(() => {
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    setIsDark(savedTheme === 'dark');
  }
}, []);
```

### **2. Estilos n√£o Aplicados**
```javascript
// Problema: Classes Tailwind n√£o funcionam
// Solu√ß√£o: Verificar content no tailwind.config.js
module.exports = {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}", // ‚Üê Incluir todos os arquivos
  ],
  // ...
}
```

### **3. Performance Lenta**
```jsx
// Problema: Re-renders desnecess√°rios
// Solu√ß√£o: Usar React.memo e useCallback
const Component = memo(({ data, onUpdate }) => {
  const handleUpdate = useCallback((id) => {
    onUpdate(id);
  }, [onUpdate]);

  return <div>{/* content */}</div>;
});
```

### **4. Hydration Errors (SSR)**
```jsx
// Problema: Diferen√ßas entre servidor e cliente
// Solu√ß√£o: Usar useEffect para c√≥digo client-side
const [mounted, setMounted] = useState(false);

useEffect(() => {
  setMounted(true);
}, []);

if (!mounted) {
  return null; // ou skeleton
}

return <ClientOnlyComponent />;
```

---

## ‚úÖ **Checklist de Qualidade**

### **Antes de Fazer Deploy**
- [ ] **Funcionalidade**
  - [ ] Todas as funcionalidades testadas
  - [ ] Formul√°rios validados
  - [ ] Estados de loading/error implementados
  - [ ] Navega√ß√£o funcionando

- [ ] **Design**
  - [ ] Dark mode funcionando em todos os componentes
  - [ ] Responsividade testada (mobile, tablet, desktop)
  - [ ] Espa√ßamentos consistentes
  - [ ] Tipografia hier√°rquica

- [ ] **Performance**
  - [ ] Bundle size otimizado
  - [ ] Imagens otimizadas
  - [ ] Lazy loading implementado
  - [ ] Memoiza√ß√£o onde necess√°rio

- [ ] **Acessibilidade**
  - [ ] Navega√ß√£o por teclado
  - [ ] Screen reader friendly
  - [ ] Contraste adequado
  - [ ] Focus vis√≠vel

- [ ] **C√≥digo**
  - [ ] Sem console.logs em produ√ß√£o
  - [ ] Error boundaries implementados
  - [ ] Tratamento de erros adequado
  - [ ] C√≥digo documentado

### **Testes Recomendados**
```javascript
// Teste de componente
import { render, screen } from '@testing-library/react';
import { ThemeProvider } from '../hooks/useTheme';
import Button from '../components/ui/Button';

test('renders button with correct styles', () => {
  render(
    <ThemeProvider>
      <Button variant="primary">Click me</Button>
    </ThemeProvider>
  );
  
  const button = screen.getByRole('button');
  expect(button).toHaveClass('btn-primary');
});

// Teste de dark mode
test('applies dark mode classes', () => {
  render(
    <ThemeProvider>
      <div className="bg-white dark:bg-gray-800">Content</div>
    </ThemeProvider>
  );
  
  // Simular toggle de tema
  // Verificar se classes dark: s√£o aplicadas
});
```

---

## üìä **M√©tricas de Qualidade**

### **Performance Targets**
- **First Contentful Paint**: < 1.5s
- **Largest Contentful Paint**: < 2.5s
- **Cumulative Layout Shift**: < 0.1
- **Bundle Size**: < 500KB (gzipped)

### **Acessibilidade Targets**
- **WCAG Level**: AA
- **Contraste M√≠nimo**: 4.5:1
- **Keyboard Navigation**: 100%
- **Screen Reader**: Compat√≠vel

### **Browser Support**
- **Chrome**: √öltimas 2 vers√µes
- **Firefox**: √öltimas 2 vers√µes
- **Safari**: √öltimas 2 vers√µes
- **Edge**: √öltimas 2 vers√µes

---

*Seguindo estas pr√°ticas, voc√™ garantir√° que sua implementa√ß√£o do ALTVORA Design System seja robusta, acess√≠vel e perform√°tica.*
